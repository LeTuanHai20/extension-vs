"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const Ze=require("path"),We=require("vscode-nls"),Be=We.loadMessageBundle(),t=require("vscode"),g=require("vscode-languageclient"),Ge=require("./html/tagClosing");var Qe;function Ue(e,n){let r=n.subscriptions,i=Ze.join(n.extensionPath,"out","src","html","HtmlLanguageServerWrapper.js"),a={run:{module:i,transport:g.TransportKind.ipc},debug:{module:i,transport:g.TransportKind.ipc,options:{execArgv:["--nolazy","--inspect=6045"]}}},o=["php"],s={documentSelector:o,synchronize:{configurationSection:["html","css","javascript"]},initializationOptions:{embeddedLanguages:{css:!0,javascript:!0},extensionPath:e.extensionPath}},l=new g.LanguageClient("php",Be("htmlserver.name","PHP (HTML language server)"),a,s);l.registerProposedFeatures(),l.registerFeature({fillClientCapabilities(e){let n=e.textDocument;n||(n=e.textDocument={}),n.foldingRange={dynamicRegistration:!1,rangeLimit:5e3,lineFoldingOnly:!0}},initialize(e,n){}});let c=l.start();r.push(c),l.onReady().then(()=>{c=Ge.g((e,n)=>{let t=l.code2ProtocolConverter.asTextDocumentPositionParams(e,n);return l.sendRequest(Qe.type,t)},{php:!0},"html.autoClosingTags"),r.push(c),r.push(c)}),t.languages.setLanguageConfiguration("php",{indentationRules:{increaseIndentPattern:/<(?!\?|(?:area|base|br|col|frame|hr|html|img|input|link|meta|param)\b|[^>]*\/>)([-_\.A-Za-z0-9]+)(?=\s|>)\b[^>]*>(?!.*<\/\1>)|<!--(?!.*-->)|\{[^}"']*$/,decreaseIndentPattern:/^\s*(<\/(?!html)[-_\.A-Za-z0-9]+\b[^>]*>|-->|\})/},wordPattern:/(-?\d*\.\d\w*)|([^\`\~\!\@\$\^\&\*\(\)\=\+\[\{\]\}\\\|\;\:\'\"\,\.\<\>\/\s]+)/g,onEnterRules:[{beforeText:new RegExp(`<(?!(?:${exports.m.join("|")}))([_:\\w][_:\\w-.\\d]*)([^/>]*(?!/)>)[^<]*$`,"i"),afterText:/^<\/([_:\w][_:\w-.\d]*)\s*>/i,action:{indentAction:t.IndentAction.IndentOutdent}},{beforeText:new RegExp(`<(?!(?:${exports.m.join("|")}))(\\w[\\w\\d]*)([^/>]*(?!/)>)[^<]*$`,"i"),action:{indentAction:t.IndentAction.Indent}}]});const d=/^(\s*)(<(!(-(-\s*(#\w*)?)?)?)?)?$/;return t.languages.registerCompletionItemProvider(o,{provideCompletionItems(e,n){let r=e.getText(new t.Range(new t.Position(n.line,0),n)).match(d);if(r){let e=new t.Range(new t.Position(n.line,r[1].length),n),i=new t.CompletionItem("#region",t.CompletionItemKind.Snippet);i.range=e,i.insertText=new t.SnippetString("\x3c!-- #region $1--\x3e"),i.documentation=Be("folding.start","Folding Region Start"),i.filterText=r[2],i.sortText="za";let a=new t.CompletionItem("#endregion",t.CompletionItemKind.Snippet);return a.range=e,a.insertText=new t.SnippetString("\x3c!-- #endregion --\x3e"),a.documentation=Be("folding.end","Folding Region End"),a.filterText=r[2],a.sortText="zb",[i,a]}return null}}),c}exports.m=["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"],function(e){e.type=new g.RequestType("html/tag")}(Qe||(Qe={})),exports.v=Ue;